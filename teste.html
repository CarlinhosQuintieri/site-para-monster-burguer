<!DOCTYPE html>
<html>
    <head>
        <title>Geocoding Service</title> 
    </head>
    <body>
        <!-- 1. Create a searchbox where the user will provide the text address -->
        <div id="floating-panel">
            <input id="address" type="textbox" value="Sydney, NSW" />
            <input id="submit-btn" type="button" value="Geocode" />
        </div>

        <div id="map" style="height: 500px;"></div>

        <!-- Async script executes immediately and must be after any DOM elements used in callback. -->
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAbawdnHQjzfhKJ3L0Coxy_CqnKsQxfOs4&callback=initMap" async></script>

        <script>
            // 1. Initialize a basic map
            function initMap() {
                const map = new google.maps.Map(document.getElementById("map"), {
                    zoom: 8,
                    center: {
                        lat: -34.397,
                        lng: 150.644
                    }
                });

                // 2. Initialize the GeoCoder API
                const geocoder = new google.maps.Geocoder();

                // 3. So when the user clicks on the submit BTN, geocode the given address if possible
                document.getElementById("submit-btn").addEventListener("click", () => {
                    geocodeAddress(geocoder, map);
                });
            }

            // Handle conversion of text address to coordinates
            function geocodeAddress(geocoder, resultsMap) {
                const address = document.getElementById("address").value;

                // Search for the address with the API
                geocoder.geocode({ address: address }, (results, status) => {
                    if (status === "OK") {
                        // Display response in the console
                        console.log(results);

                        // Set the location of the map obtained by the API
                        resultsMap.setCenter(results[0].geometry.location);

                        // Add the marker with the obtained location
                        new google.maps.Marker({
                            map: resultsMap,
                            position: results[0].geometry.location,
                        });
                    } else {
                        alert("Geocode error: " + status);
                    }
                });
            }
        </script>
    </body>
</html>